<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="csrf-token" content="{{ csrf_token() }}">
  <title>Monkey's Paw: Wishbreaker</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div id="backgroundOverlay"></div>
  <div id="gameSection" style="display:none;">
    <div id="streakDisplay" style="font-size:1.3rem; margin-bottom:1rem; color:orange; font-weight:bold;">
      🔥 Current Streak: 0
      <span id="wishesCount" style="font-size:1.3rem; margin-bottom: 1rem; color:#ffd700; margin-left:1.2em; font-weight:bold;">✨ Wishes Made: 0</span>
      <span id="avoidedTwistsCount" style="font-size:1.3rem; margin-bottom: 1rem; color:limegreen; margin-left:1.2em; font-weight:bold;">🛡️ Avoided Twists: 0</span>
    </div>
    <div id="winMessage" style="font-size:1.1rem; margin-bottom:1rem; color:limegreen;"></div>
    <div id="gameOverMsg" style="font-size:1.2rem; color:crimson; margin-bottom:1rem;"></div>
    <h1>🪙 Monkey's Paw: Wishbreaker</h1>
    <div id="wishInputRow" style="display:flex; align-items:stretch; justify-content:center; gap:0; margin-bottom:1em; max-width:600px; margin-left:auto; margin-right:auto;">
      <span style="background:#222; color:#ffd700; display:flex; align-items:center; border-radius:5px 0 0 5px; font-size:1.1rem; font-family:inherit; border:1px solid #444; border-right:none; min-width:70px; justify-content:center; height:44px; box-sizing:border-box; padding:0 1rem;">I Wish</span>
      <input type="text" id="wishInput" placeholder="for infinite pizza..." style="font-size:1.1rem; border-radius:0 5px 5px 0; border:1px solid #444; height:44px; width:100%; min-width:120px; max-width:350px; box-sizing:border-box; padding:0 0.7rem; margin:0;" />
    </div>
    <div class="wish-submit-container">
      <button onclick="makeWish()">Submit Wish</button>
      <div class="spellbook-icon" title="Spellbook" onclick="openSpellbook()">
        <img src="/static/images/spellbook.png" alt="Spellbook" width="50" height="50">
      </div>
    </div>
    <div class="result" id="twistResult"></div>
    <div id="userOutcomeBox" style="margin:1rem auto; max-width:350px; font-size:1.2rem; font-weight:bold; display:none; border-radius:6px; padding:0.7rem 1rem;"></div>
  </div>

  <div id="leaderboardSection" style="margin-top:2rem;">
    <div class="leaderboard-header">
      <h2>🏆 Leaderboard</h2>
    </div>
    <div class="leaderboard-container">
      <table id="leaderboardTable">
        <thead>
          <tr>
            <th>Rank</th>
            <th>Player</th>
            <th>High Score</th>
            <th>Avoided Twists</th>
            <th>Streak</th>
          </tr>
        </thead>
        <tbody id="leaderboardBody">
        </tbody>
      </table>
    </div>
  </div>

  <!-- Spellbook Modal -->
  <div id="spellbookModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>📚 Ancient Spellbook</h2>
        <span class="close">&times;</span>
      </div>
      <div class="modal-body">
        <p class="spellbook-intro">The ancient tome reveals wisdom for crafting wishes that may avoid the paw's curse...</p>
        <div id="wishSuggestions" class="wish-suggestions">
          <div class="loading">Consulting the ancient texts...</div>
        </div>
        <div class="spellbook-footer">
          <p class="success-rate">💡 These suggestions may improve your chances by ~20%</p>
        </div>
      </div>
    </div>
  </div>

  <script src="/static/script.js"></script>
</body>
</html>
